<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Convert .lab to textgrid</h1><p class="page-description">Because the lab is Praatland</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-08-31T00:00:00-05:00" itemprop="datePublished">
        Aug 31, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/notes/categories/#lab">lab</a>
        &nbsp;
      
        <a class="category-tags-link" href="/notes/categories/#speech">speech</a>
        &nbsp;
      
        <a class="category-tags-link" href="/notes/categories/#textgrid">textgrid</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-08-31-lab_to_textgrid.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">praatio</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting praatio
  Downloading praatio-5.0.0-py3-none-any.whl (76 kB)
     |████████████████████████████████| 76 kB 2.9 MB/s 
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from praatio) (3.7.4.3)
Installing collected packages: praatio
Successfully installed praatio-5.0.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_read_lab</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">skip_empty_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">skip_empty_labels</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">%%</span><span class="n">writefile</span> <span class="n">sample</span><span class="o">.</span><span class="n">lab</span>
<span class="mi">0</span> <span class="mi">9700000</span> <span class="n">sil</span>
<span class="mi">9700000</span> <span class="mi">10900000</span> <span class="n">i</span>
<span class="mi">10900000</span> <span class="mi">12400000</span> <span class="n">mj</span>
<span class="mi">12400000</span> <span class="mi">13100000</span> <span class="n">lj</span>
<span class="mi">13100000</span> <span class="mi">15200000</span> <span class="n">au</span>
<span class="mi">15200000</span> <span class="mi">16300000</span> <span class="n">r</span>
<span class="mi">16300000</span> <span class="mi">18100000</span> <span class="n">sil</span>
<span class="mi">18100000</span> <span class="mi">19100000</span> <span class="n">sil</span>
<span class="mi">19100000</span> <span class="mi">23700000</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Writing sample.lab
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">ll</span> <span class="o">=</span> <span class="n">_read_lab</span><span class="p">(</span><span class="s1">&#39;sample.lab&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">praatio</span> <span class="kn">import</span> <span class="n">textgrid</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">praatio.utilities.constants</span> <span class="kn">import</span> <span class="n">Interval</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Interval</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">10000000.0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">10000000.0</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">tier_start</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tier_end</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">out</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Interval(start=0.0, end=0.97, label=&#39;sil&#39;),
 Interval(start=0.97, end=1.09, label=&#39;i&#39;),
 Interval(start=1.09, end=1.24, label=&#39;mj&#39;),
 Interval(start=1.24, end=1.31, label=&#39;lj&#39;),
 Interval(start=1.31, end=1.52, label=&#39;au&#39;),
 Interval(start=1.52, end=1.63, label=&#39;r&#39;),
 Interval(start=1.63, end=1.81, label=&#39;sil&#39;),
 Interval(start=1.81, end=1.91, label=&#39;sil&#39;),
 Interval(start=1.91, end=2.37, label=&#39;&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">tg</span> <span class="o">=</span> <span class="n">textgrid</span><span class="o">.</span><span class="n">Textgrid</span><span class="p">()</span>
<span class="n">phone_tier</span> <span class="o">=</span> <span class="n">textgrid</span><span class="o">.</span><span class="n">IntervalTier</span><span class="p">(</span><span class="s1">&#39;phones&#39;</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">tier_start</span><span class="p">,</span> <span class="n">tier_end</span><span class="p">)</span>
<span class="n">tg</span><span class="o">.</span><span class="n">addTier</span><span class="p">(</span><span class="n">phone_tier</span><span class="p">)</span>
<span class="n">tg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;out.TextGrid&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;long_textgrid&quot;</span><span class="p">,</span> <span class="n">includeBlankSpaces</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">cat</span> <span class="n">out</span><span class="o">.</span><span class="n">TextGrid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>File type = &#34;ooTextFile&#34;
Object class = &#34;TextGrid&#34;

xmin = 0 
xmax = 2.37 
tiers? &lt;exists&gt; 
size = 1 
item []: 
    item [1]:
        class = &#34;IntervalTier&#34; 
        name = &#34;phones&#34; 
        xmin = 0 
        xmax = 2.37 
        intervals: size = 9 
        intervals [1]:
            xmin = 0 
            xmax = 0.97 
            text = &#34;sil&#34; 
        intervals [2]:
            xmin = 0.97 
            xmax = 1.09 
            text = &#34;i&#34; 
        intervals [3]:
            xmin = 1.09 
            xmax = 1.24 
            text = &#34;mj&#34; 
        intervals [4]:
            xmin = 1.24 
            xmax = 1.31 
            text = &#34;lj&#34; 
        intervals [5]:
            xmin = 1.31 
            xmax = 1.52 
            text = &#34;au&#34; 
        intervals [6]:
            xmin = 1.52 
            xmax = 1.63 
            text = &#34;r&#34; 
        intervals [7]:
            xmin = 1.63 
            xmax = 1.81 
            text = &#34;sil&#34; 
        intervals [8]:
            xmin = 1.81 
            xmax = 1.91 
            text = &#34;sil&#34; 
        intervals [9]:
            xmin = 1.91 
            xmax = 2.37 
            text = &#34;&#34; 
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="jimregan/notes"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/notes/lab/speech/textgrid/2021/08/31/lab_to_textgrid.html" hidden></a>
</article>