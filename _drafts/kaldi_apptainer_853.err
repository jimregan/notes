/var/spool/slurmd/job00853/slurm_script: line 12: module: command not found
/opt/kaldi/egs/sprakbanken_swe/s5/steps/libs/common.py:127: SyntaxWarning: "is not" with a literal. Did you mean "!="?
  if p.returncode is not 0:
/opt/kaldi/egs/sprakbanken_swe/s5/steps/libs/common.py:147: SyntaxWarning: "is not" with a literal. Did you mean "!="?
  if p.returncode is not 0:
/opt/kaldi/egs/sprakbanken_swe/s5/steps/libs/common.py:203: SyntaxWarning: "is not" with a literal. Did you mean "!="?
  if popen_object.returncode is not 0:
2025-08-07 19:17:21,557 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:35 - <module> - INFO ] Starting chain model trainer (train.py)
2025-08-07 19:17:21,592 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:246 - process_args - WARNING ] You are running with one thread but you have not compiled
                   for CUDA.  You may be running a setup optimized for GPUs.
                   If you have GPUs and have nvcc installed, go to src/ and do
                   ./configure; make
2025-08-07 19:17:21,593 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:284 - train - INFO ] Arguments for the experiment
{'alignment_subsampling_factor': 3,
 'apply_deriv_weights': False,
 'backstitch_training_interval': 1,
 'backstitch_training_scale': 0.0,
 'chain_opts': '',
 'chunk_left_context': 0,
 'chunk_left_context_initial': -1,
 'chunk_right_context': 0,
 'chunk_right_context_final': -1,
 'chunk_width': '140,100,160',
 'cleanup': True,
 'cmvn_opts': '--norm-means=false --norm-vars=false',
 'combine_sum_to_one_penalty': 0.0,
 'command': 'run.pl',
 'compute_per_dim_accuracy': False,
 'deriv_truncate_margin': None,
 'dir': 'exp/chain/tdnn',
 'do_final_combination': True,
 'dropout_schedule': '0,0@0.20,0.5@0.50,0',
 'egs_command': 'run.pl',
 'egs_dir': None,
 'egs_nj': 0,
 'egs_opts': '--frames-overlap-per-eg 0 --constrained false',
 'egs_stage': -10,
 'email': None,
 'exit_stage': None,
 'feat_dir': 'data/train',
 'final_effective_lrate': 0.0001,
 'frame_subsampling_factor': 3,
 'frames_per_iter': 2500000,
 'initial_effective_lrate': 0.001,
 'input_model': None,
 'l2_regularize': 0.0,
 'lat_dir': 'exp/chain/tri4a_train_lats',
 'leaky_hmm_coefficient': 0.1,
 'left_deriv_truncate': None,
 'left_tolerance': 5,
 'lm_opts': '--num-extra-lm-states=2000',
 'max_lda_jobs': 10,
 'max_models_combine': 20,
 'max_objective_evaluations': 30,
 'max_param_change': 2.0,
 'momentum': 0.0,
 'num_chunk_per_minibatch': '64',
 'num_epochs': 20.0,
 'num_jobs_final': 1,
 'num_jobs_initial': 1,
 'num_jobs_step': 1,
 'online_ivector_dir': 'exp/chain/ivectors_train',
 'preserve_model_interval': 100,
 'presoftmax_prior_scale_power': -0.25,
 'proportional_shrink': 0.0,
 'rand_prune': 4.0,
 'remove_egs': True,
 'reporting_interval': 0.1,
 'right_tolerance': 5,
 'samples_per_iter': 400000,
 'shrink_saturation_threshold': 0.4,
 'shrink_value': 1.0,
 'shuffle_buffer_size': 5000,
 'srand': 0,
 'stage': -10,
 'train_opts': ['--optimization.memory-compression-level=2'],
 'tree_dir': 'exp/chain/tree',
 'use_gpu': 'yes',
 'xent_regularize': 0.1}
2025-08-07 19:17:21,750 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:341 - train - INFO ] Creating phone language-model
2025-08-07 19:17:35,235 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:346 - train - INFO ] Creating denominator FST
copy-transition-model exp/chain/tree/final.mdl exp/chain/tdnn/0.trans_mdl 
LOG (copy-transition-model[5.5.0~1-4b2b]:main():copy-transition-model.cc:62) Copied transition model.
2025-08-07 19:17:37,474 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:382 - train - INFO ] Generating egs
tree-info exp/chain/tdnn/tree 
feat-to-dim scp:exp/chain/ivectors_train/ivector_online.scp - 
2025-08-07 19:21:21,277 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:431 - train - INFO ] Copying the properties from exp/chain/tdnn/egs to exp/chain/tdnn
2025-08-07 19:21:21,285 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:454 - train - INFO ] Preparing the initial acoustic model.
2025-08-07 19:21:21,852 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:487 - train - INFO ] Training will run for 20.0 epochs = 3660 iterations
2025-08-07 19:21:21,854 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/nnet3/chain/train.py:529 - train - INFO ] Iter: 0/3659   Jobs: 1   Epoch: 0.00/20.0 (0.0% complete)   lr: 0.001000   
run.pl: job failed, log is in exp/chain/tdnn/log/compute_prob_train.0.log
2025-08-07 19:21:22,386 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/libs/common.py:212 - background_command_waiter - WARNING ] Command exited with status 1: run.pl exp/chain/tdnn/log/compute_prob_train.0.log                 nnet3-chain-compute-prob --l2-regularize=0.0                  --leaky-hmm-coefficient=0.1 --xent-regularize=0.1                 exp/chain/tdnn/0.mdl exp/chain/tdnn/den.fst                 "ark,bg:nnet3-chain-copy-egs  ark:exp/chain/tdnn/egs/train_diagnostic.cegs                     ark:- | nnet3-chain-merge-egs --minibatch-size=1:64 ark:- ark:- |"         
run.pl: job failed, log is in exp/chain/tdnn/log/compute_prob_valid.0.log
2025-08-07 19:21:22,388 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/libs/common.py:212 - background_command_waiter - WARNING ] Command exited with status 1: run.pl exp/chain/tdnn/log/compute_prob_valid.0.log                 nnet3-chain-compute-prob --l2-regularize=0.0                  --leaky-hmm-coefficient=0.1 --xent-regularize=0.1                 exp/chain/tdnn/0.mdl exp/chain/tdnn/den.fst                 "ark,bg:nnet3-chain-copy-egs  ark:exp/chain/tdnn/egs/valid_diagnostic.cegs                     ark:- | nnet3-chain-merge-egs --minibatch-size=1:64 ark:- ark:- |"         
run.pl: job failed, log is in exp/chain/tdnn/log/train.0.1.log
2025-08-07 19:21:22,602 [/opt/kaldi/egs/sprakbanken_swe/s5/steps/libs/common.py:207 - background_command_waiter - ERROR ] Command exited with status 1: run.pl --gpu 1 exp/chain/tdnn/log/train.0.1.log                     nnet3-chain-train --use-gpu=yes                      --apply-deriv-weights=False                     --l2-regularize=0.0 --leaky-hmm-coefficient=0.1                      --write-cache=exp/chain/tdnn/cache.1  --xent-regularize=0.1                                          --print-interval=10 --momentum=0.0                     --max-param-change=1.414213562373095                     --backstitch-training-scale=0.0                     --backstitch-training-interval=1                     --l2-regularize-factor=1.0 --optimization.memory-compression-level=2                      --srand=0                     "nnet3-am-copy --raw=true --learning-rate=0.001 --scale=1.0 exp/chain/tdnn/0.mdl - |nnet3-copy --edits='set-dropout-proportion name=* proportion=0.0' - - |" exp/chain/tdnn/den.fst                     "ark,bg:nnet3-chain-copy-egs                          --frame-shift=1                         ark:exp/chain/tdnn/egs/cegs.1.ark ark:- |                         nnet3-chain-shuffle-egs --buffer-size=5000                         --srand=0 ark:- ark:- | nnet3-chain-merge-egs                         --minibatch-size=32 ark:- ark:- |"                     exp/chain/tdnn/1.1.raw
