w
last
df
df -M
df --help
df -B
df -BG
nvidia-smi
ls /opt/
ls /usr/local/
ls
w
pip install youtube-dl
pip3 install youtube-dl
sudo apt install python3-pip
pip3 install youtube-dl
export PATH=$PATH:/home/joeregan/.local/bin/
which youtube-dl
export PATH=$PATH:/home/joregan/.local/bin/
which youtube-dl
Â£youtube-dl https://www.youtube.com/playlist?list=PLT9Ueuz3S2P0DLUrwt2T2ZwMjfciZaMs9
mkdir svenska-bocker
cd svenska-bocker/
youtube-dl  -o '%(id)s.%(ext)s' https://www.youtube.com/playlist?list=PLT9Ueuz3S2P0DLUrwt2T2ZwMjfciZaMs9
ls
cd svenska-bocker/
ls
youtube-dl  -o '%(id)s.%(ext)s' https://www.youtube.com/playlist?list=PLT9Ueuz3S2P0DLUrwt2T2ZwMjfciZaMs9
w
last
cd svenska-bocker/
youtube-dl  -o '%(id)s.%(ext)s' https://www.youtube.com/playlist?list=PLT9Ueuz3S2P0DLUrwt2T2ZwMjfciZaMs9
cd svenska-bocker/
nohup youtube-dl  -o '%(id)s.%(ext)s' https://www.youtube.com/playlist?list=PLT9Ueuz3S2P0DLUrwt2T2ZwMjfciZaMs9 &
tail -f nohup.out 
nohup youtube-dl -i  -o '%(id)s.%(ext)s' https://www.youtube.com/playlist?list=PLT9Ueuz3S2P0DLUrwt2T2ZwMjfciZaMs9 &
tail -f nohup.out 
w
ls
tail -f svenska-bocker/nohup.out 
w
last
df
pip3 install datasets
python3
tmux attach
tmux attach
tmux create
tmux 
top
less .cache/huggingface/datasets/downloads/f3f64b8496d7555d80bee4791715ce45c2aa1635c208cc2d52cb5cb9221d07e2.json 
vi nst.py 
tmux attach
w
df
ls ..
top
wget https://www.nb.no/sbfil/talegjenkjenning/16kHz_2020/se_2020/ADB_SWE_0467.tar.gz
tar ztvf ADB_SWE_0467.tar.gz 
mkdir json
cd json/
tar zxvf ../ADB_SWE_0467.tar.gz 
pwd
less se99x914-11081999-1125_r4670915.json 
top
grep '"F"' *json
grep '"F"' *json|grep -v '"text"'
for i in *json;do grep '"info"' $i || echo $i >> missing-info;done
cd ..
python3 json
python3 json-check.py 
top
pip install soundfile
pip install sndfile
ls
python3
w
lspci
lspci|grep NVIDIA
nvidia-smi --query-gpu=name,memory.total,driver_version --format=csv|awk -F', ' '{print "| " $1 " | " $2 " | " $3 " |"}'
cat /etc/issue.net 
nvidia-smi --query-gpu=name,memory.total,driver_version --format=csv|awk -F', ' '{print "| " $1 " | " $2 " | " $3 " |"}'
less /etc/netplan/00-installer-config.yaml
sudo vi /etc/netplan/00-installer-config.yaml
sudo netplan apply
ping 10.210.242.10
cp /etc/netplan/00-installer-config.yaml .
sudo vi /etc/netplan/00-installer-config.yaml
sudo ifconfig eno2 down
sudo netplan apply
sudo apt install python3-pip
sudo apt install net-tools
ping www.google.com
less 00-installer-config.yaml 
sudo vi /etc/netplan/00-installer-config.yaml
sudo cp 00-installer-config.yaml /etc/netplan/00-installer-config.yaml
sudo vi /etc/netplan/00-installer-config.yaml
route -n
sudo vi /etc/netplan/00-installer-config.yaml
netplan validate
netplan try
sudo netplan try
sudo vi /etc/netplan/00-installer-config.yaml
sudo netplan try
ping www.google.com
ping 10.210.242.10
cat /etc/netplan/00-installer-config.yaml
cat 00-installer-config.yaml 
sudo vi /etc/netplan/00-installer-config.yaml
cat /etc/netplan/00-installer-config.yaml
ping http://10.210.240.5/
ping 10.210.240.5
ping 10.210.240.7
ping 10.210.240.6
ssh 10.210.240.6
ssh -l ADMIN 10.210.240.6
ssh -l ADMIN 10.210.240.5
lynx http://10.210.240.5
cat /etc/netplan/00-installer-config.yaml
ping 10.210.240.6
cat /etc/netplan/00-installer-config.yaml
ping 10.210.242.10
cat /etc/netplan/00-installer-config.yaml
ping 130.237.3.102
ping 10.210.240.4
ping 10.210.242.10
traceroute 10.210.242.10
sudo apt install inetutils-traceroute 
traceroute 10.210.242.10
cat 00-installer-config.yaml 
sudo vi /etc/netplan/00-installer-config.yaml
cat /etc/netplan/00-installer-config.yaml
sudo systemctl enable systemd-resolved.service
#sudo systemctl enable systemd-resolved.service
#sudo systemctl enable systemd-networkd.service
ping 130.237.3.101
ping 10.210.240.5
#130.237.3.101
cat 00-installer-config.yaml 
cat /etc/netplan/00-installer-config.yaml
ping 10.210.240.5
ping 130.237.3.101
sudo reboot
python3
vi nst.py
python3
rm nst.py 
vi nst.py
python3
vi nst.py
rm nst.py
vi nst.py
python3
vi nst.py
python3
ls
ls svenska-bocker/
tail svenska-bocker/nohup.out 
ls svenska-bocker/|wc
cd ..
cd 
ls
ls ..
ls
rm nst.py 
vi nst.py 
python3
rm nst.py 
vi nst.py 
python3
sudo passwd jedlund 
ping 10.210.242.130
traceroute 10.210.242.130
sudo vi /etc/netplan/00-installer-config.yaml 
sudo netplan apply
mkdir tmp
sudo mount -t nfs tmh-vnas.net.kth.se:/tmh_edlund_vol3 tmp
sudo apt install nfs-common
sudo mount -t nfs tmh-vnas.net.kth.se:/tmh_edlund_vol3 tmp
sudo apt install nfs-common 
mkdir /sbtal
sudo mkdir /sbtal
sudo vi /etc/netplan/00-installer-config.yaml 
sudo mount -o v3 -t nfs tmh-vnas.net.kth.se:/tmh_edlund_vol3 /sbtal
ls -al /sbtal/
ls
ls -al
nvidia-smi 
ls
git clone https://huggingface.co/datasets/jimregan/sbtal_riksdag_asr
ls
cd sbtal_riksdag_asr/
ls
git status
git pull 
vi sbtal_riksdag_asr.py 
ls /sbtal/
vi sbtal_riksdag_asr.py 
cd ..
wget https://docs.conda.io/en/latest/miniconda.html#linux-installers
rm miniconda.html 
wget https://repo.anaconda.com/miniconda/Miniconda3-py310_23.1.0-1-Linux-x86_64.sh
bash Miniconda3-py310_23.1.0-1-Linux-x86_64.sh 
conda create --name hf
. .bashrc 
conda create --name hf
conda activate hf
conda install ffmpeg
conda install -c huggingface transformers
ls
python
which pip
pip install datasetzs
pip install datasets
python
pip install pydub
python
pip uninstall datasets
conda install -c huggingface -c conda-forge datasets
python
conda install -c conda-forge pysoundfile
python
tmux attach
tmux 
tmux  attach
source activate hf
ls
ls subset-fairseq/
less sbtal_subset.tsv 
less sbtal_subset.ltr 
less sbtal_subset.tsv 
tail -f sbtal_subset.tsv 
wc -l sbtal_subset.*
tail -f sbtal_subset.tsv 
wc -l sbtal_subset.*
less sbtal_subset.ltr 
less sbtal_subset.tsv 
wc -l sbtal_subset.*
wc -l sbtal_subset*
less sbtal_subset-combined.tsv 
wc -l sbtal_subset*
less sbtal_subset.tsv 
less sbtal_subset-combined.tsv 
wc -l sbtal_subset*
ls sbtal_subset
ls sbtal_subset*
wc -l sbtal_subset*
tail -f sbtal_subset-combined.tsv 
tail -f sbtal_subset-combined.l
tail -f sbtal_subset.ltr 
wc -l sbtal_subset*
cat sbtal_subset.tsv 
cat sbtal_subset.tsv |awk -F'\t' '{print $NF}'
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c}'
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / 1000}'
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
ls -al
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
ls -al
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
wc -l sbtal_subset*
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
wc -l sbtal_subset*
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
wc -l sbtal_subset*
cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
date; cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
ls
less test.tsv 
less valid.tsv 
less test.tsv 
less valid.tsv 
less train-valid-deliverable/round1/C1A1/sweterror-30-1-a.tsv 
less train-valid-deliverable/round1/C1A1/sweterror-30-1-b.tsv 
less valid.tsv 
rm valid.tsv test.tsv 
less valid.tsv 
cat valid.tsv 
cat valid.tsv |awk -F'\t' '{print $1 "\t" $2}' > fairseq-valid.tsv
cat test.tsv |awk -F'\t' '{print $1 "\t" $2}' > fairseq-test.tsv
vi fairseq-valid.tsv 
vi fairseq-test.tsv 
cat test.tsv |awk -F'\t' '{print $3}'
cat test.tsv |awk -F'\t' '{print $3}'|perl -ane 'chomp;s/ /|/g;print(join(" ", split//) . " |\n"'
cat test.tsv |awk -F'\t' '{print $3}'|perl -ane 'chomp;s/ /|/g;print join(" ", split//) . " |\n"'
cat test.tsv |awk -F'\t' '{print $3}'|perl -C7 -ane 'chomp;s/ /|/g;print join(" ", split//) . " |\n"'
cat test.tsv |awk -F'\t' '{print $3}'|perl -C7 -ane 'chomp;s/ /|/g;print join(" ", split//) . " |\n"' > fairseq-test.ltr
cat valid.tsv |awk -F'\t' '{print $3}'|perl -C7 -ane 'chomp;s/ /|/g;print join(" ", split//) . " |\n"' > fairseq-valid.ltr
wc -l fairseq-*
less fairseq-valid.tsv 
less fairseq-valid.ltr 
vi fairseq-valid.ltr 
vi fairseq-test.ltr 
cat test.tsv 
cat test.tsv |awk -F'\t' '{print $1 "\t" $3}'
cat test.tsv |awk -F'\t' '{print $1 "\t" $3}' > hf-test.tsv
cat valid.tsv |awk -F'\t' '{print $1 "\t" $3}' > hf-valid.tsv
less valid.tsv 
less hf-valid.tsv 
date; cat sbtal_subset.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
source activate base
conda activate hf
conda install -n hf ipykernel --update-deps --force-reinstall
which python
mkdir ~/subset-fairseq
mkdir /home/joregan/sbtal_riksdag_subset
python make-fairseq.py 
less sbtal_subset.tsv 
ls sbtal_riksdag_subset/
rm -rf sbtal_riksdag_subset/
rm sbtal_subset.tsv 
rm sbtal_subset.ltr 
mkdir sbtal_riksdag_subset/
python make-fairseq.py 
ls
wc -l sbtal_subset.ltr 
wc -l sbtal_subset.tsv 
rm sbtal_*
rm -rf sbtal_riksdag_subset/
ls
mkdir sbtal_riksdag_subset/
ls
python make-fairseq.py 
rm sbtal_subset*
rm sbtal_riksdag_subset/244220*
python make-fairseq.py 
ls
conda create --name fairseq
conda activate fairseq
conda install -c conda-forge fairseq
fairseq-train --help
conda uninstall fairseq
conda install pip
which pip
pip install git+https://github.com/pytorch/fairseq
fairseq-train --help
ls
gzip -d checkpoint_last.pt.gz 
mkdir kb_wav2vec2_checkpoint
mv checkpoint_last.pt kb_wav2vec2_checkpoint/
tmux attach
ls
ls svenska-bocker/
less sbtal_riksdag_asr/sbtal_riksdag_asr.py 
conda activate hf
python
ls
rm -rf C1_audio/
ls
ls train-valid-deliverable/
cd train-valid-deliverable/
ls
mkdir split
python
ls
less round1/C1A1/sweterror-01-1-a.tsv 
less sbtal_riksdag_asr/sbtal_riksdag_asr.py 
cd ..
less sbtal_riksdag_asr/sbtal_riksdag_asr.py 
ls train-valid-deliverable/split/
ls train-valid-deliverable/C1_audio/
ls 
ls train-valid-deliverable/
ls train-valid-deliverable/split/
cd sbtal_riksdag_asr/
git diff
git checkout -b subset
git add sbtal_riksdag_asr.py 
git commit -m 'subset to 100h'
git config --global user.email 'joregan@kth.se'
git config --global user.name "Jim O'Regan"
git commit -m 'subset to 100h'
ls
less sbtal_riksdag_asr.py 
vi sbtal_riksdag_asr.py 
git add sbtal_riksdag_asr.py 
git commit -m 'forgetting to increment the total is exactly what I did not need with a deadline tomorrow'
git branch
git branch show
git remote show
git remote show origin 
git push origin subset 
cp sbtal_riksdag_asr.py ../make-fairseq.py
cd ..
tmux attach
nvidia-smi 
less ~/.huggingface/token 
scp ~/.huggingface/token joregan@130.237.3.106:.huggingface
scp ~/.huggingface/token 130.237.3.106:.huggingface
tmux attach
cd fairseq-tensorboard/
ls
less train/events.out.tfevents.1677688417.sbtaldeep24 
df
ls
ls train
cd ..
ls
rm Miniconda3-py310_23.1.0-1-Linux-x86_64.sh 
conda activate hf
git clone https://github.com/PSST-Challenge/psstbaseline
cd psstbaseline/
ls
ls ../wav2vec2-swedish-riksdag-100h/
ls $HOME/wav2vec2-swedish-riksdag-100h/
echo $HOME/wav2vec2-swedish-riksdag-100h/
vi step_1c_convert_fairseq_to_huggingface.py 
ls
ls ..
echo $HOME/kb_wav2vec2_checkpoint/
echo $HOME/kb_wav2vec2_checkpoint/checkpoint_last.pt 
vi step_1c_convert_fairseq_to_huggingface.py 
find ../outputs/2023-03-01/ -type f
mkdir ../cp
cp ../outputs/2023-03-01/16-30-34/checkpoints/checkpoint_best.pt ../cp/
ls $HOME/cp
echo $HOME/cp/checkpoint_best.pt 
vi step_1c_convert_fairseq_to_huggingface.py 
python step_1c_convert_fairseq_to_huggingface.py 
#!conda install -y pytorch torchvision torchaudio pytorch-cuda=11.7 -c pytorch -c nvidia
conda install -y pytorch torchvision torchaudio pytorch-cuda=11.7 -c pytorch -c nvidia
conda uninstall -y pytorch torchvision torchaudio pytorch-cuda=11.7 
conda install -y pytorch torchvision torchaudio pytorch-cuda=11.7 -c pytorch -c nvidia
conda activate fairseq
pip install transformers
ls
python step_1c_convert_fairseq_to_huggingface.py 
ls ../wav2vec2-swedish-riksdag-100h/
ls
ls ..
find ../outputs/ -name '*pt'
cp ../outputs/2023-03-01/16-30-34/checkpoints/checkpoint_best.pt ../cp/
python step_1c_convert_fairseq_to_huggingface.py 
less ../fairseq-config/riksdag_100h.yaml 
ls ..
vi step_1c_convert_fairseq_to_huggingface.py 
cd ..
git clone https://huggingface.co/HfSpeechUtils/convert_wav2vec2_to_hf
cd convert_wav2vec2_to_hf/
ls
less run_convert.sh 
ls
less run_forward.py 
less run_convert.sh 
ls
cd ..
rm -rf convert_wav2vec2_to_hf/
ls
git clone https://github.com/huggingface/transformers
cd transformers/
find . -name convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py
python ./src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder ../wav2vec2-swedish-riksdag-100h/ --checkpoint_path ../cp/checkpoint_best.pt --dict_path ../fairseq-data/dict.ltr.txt 
python ./src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --help
less ./src/transformers/models/wav2vec2/configuration_wav2vec2.py 
wget https://huggingface.co/facebook/wav2vec2-base-960h/resolve/main/config.json
less config.json 
python ./src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder ../wav2vec2-swedish-riksdag-100h/ --checkpoint_path ../cp/checkpoint_best.pt --dict_path ../fairseq-data/dict.ltr.txt --config_path config.json 
cd ../wav2vec2-swedish-riksdag-100h/
ls
cd runs/
ls
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
ls
git status
git add .
conda activate hf
git add .
git commit -m 'update tensorboard'
git push 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git status
git add .
git commit -m update
cd ..
ls
cd transformers/
conda activate fairseq
less config.json 
python ./src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder ../wav2vec2-swedish-riksdag-100h/ --checkpoint_path ../cp/checkpoint_best.pt --dict_path ../fairseq-data/dict.ltr.txt --config_path config.json 
less ./src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py 
less ./src/transformers/models/wav2vec2/configuration_wav2vec2.py 
less ../kb_wav2vec2_checkpoint/checkpoint_last.pt 
strings ../kb_wav2vec2_checkpoint/checkpoint_last.pt 
strings ../kb_wav2vec2_checkpoint/checkpoint_last.pt |less
cd ..
cd wav2vec2-swedish-riksdag-100h/
ls
cd runs/
ls
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
conda activate hf
git add .
git commit -m update
git push 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git status
git add .
less ../vocab.json 
less ../special_tokens_map.json 
less ../tokenizer_config.json 
git commit -m update
git push 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
git commit -m update
git push 
nvidia-smi 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
git push 
git commit -m update
git push 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
git commit -m update
git push 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
git commit -m update
git push 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
git commit -m update
git push 
cd ..
ls
wget https://huggingface.co/KBLab/wav2vec2-large-voxrex-swedish/raw/main/config.json
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h/ --checkpoint_path $HOME/cp/checkpoint_best.pt --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
conda activate fairseq
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h/ --checkpoint_path $HOME/cp/checkpoint_best.pt --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
ls
git status
git add .
git checkout hf
conda activate hf
git add .
find $HOME/outputs/ -name '*.pt'
find $HOME/outputs/ -name '*_best.pt'
git commit -m 'last copied cp'
conda activate fairseq
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt') --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
ls
git status
conda activate hf
git status
cd runs/
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
cd ..
it add config.json ls
ls
git add pytorch_model.bin
git commit -m 'epoch 161'
git push 
git pull
ls
cd ../sbtal_riksdag_asr/
git branch
git checkout subset 
ls
less process_data.ipynb 
ls
cd ../wav2vec2-swedish-riksdag-100h/
ls
cd runs/
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
git commit -m update
git push 
for i in * ;do cp -r ~/fairseq-tensorboard/$i .; done
git add .
git commit -m update
git push 
ls
cd ../../wav2vec2-swedish-riksdag-200h/
ls
git add runs/
git commit -m start
git push 
git add runs/
git commit -m update
git push 
git status
git add runs/
git commit -m update
git push 
git status
git add .
git commit -m update
git push 
git add .
git commit -m update
git push 
#python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt') --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
$(find $HOME/outputs/ -name '*_best.pt')
ls -al $(find $HOME/outputs/ -name '*_best.pt')
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-200h/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
conda activate fairseq
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-200h/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
cp ../wav2vec2-swedish-riksdag-100h/config.json .
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-200h/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
git status
git add .
git commit -m epoch\ 300
git push 
ls ..
ls ../sbtal_riksdag_asr/alignments/
ls ../sbtal_riksdag_asr/alignments/2442206050014933021.ctm_edit 
less ../sbtal_riksdag_asr/alignments/2442206050014933021.ctm_edit 
less ../sbtal_riksdag_asr/alignments/2442206050014926221.ctm_edit 
ls
ls ..
less ../fairseq-data2/train.tsv 
ls /home/joregan/sbtal_riksdag_subset2/
ls
less config.json 
ls ..
cp ../fairseq-config/riksdag_200h.yaml .
git add riksdag_200h.yaml 
git commit -m add config
git commit -m 'add config'
less riksdag_200h.yaml 
ls
cd ../wav2vec2-swedish-riksdag-100h/
ls
cp ../fairseq-config/riksdag_100h.yaml .
git add riksdag_100h.yaml 
git commit -m 'add fairseq config file'
git push
ls
less riksdag_100h.yaml 
cd ..
ls
ls hf-valid
ls
less fairseq-data2/train.tsv 
cd wav2vec2-swedish-riksdag-100h/
git status
git branch
git branch -a
cd ..
rm -rf wav2vec2-swedish-riksdag-100h/
cd wav2vec2-swedish-riksdag-200h/
git status
git add runs/
git commit -m 'last updatre'
git push
git lfs prune
ls
cd ..
cd wav2vec2-swedish-riksdag-200h/
git branch -a
cd ..
rm -rf wav2vec2-swedish-riksdag-200h/
ls
ls *py
less make-fairseq.py 
ls
ls sbtal_riksdag_asr/
ls sbtal_riksdag_asr/fairseq-data/dict.ltr.txt 
cat sbtal_riksdag_asr/fairseq-data/dict.ltr.txt 
cat sbtal_riksdag_asr/fairseq-data/dict.ltr.txt |grep -v '|'
cat sbtal_riksdag_asr/fairseq-data/dict.ltr.txt |grep -v '|'|awk '{print $1}'|tr -d '\n'
ls
less make-fairseq.py 
head make-fairseq.py 
grep align make-fairseq.py 
ls sbtal_riksdag_asr/alignments/
vi make-fairseq.py 
ls
ls chunked/
vi make-fairseq.py 
python make-fairseq.py 
mkdir /home/joregan/sbtal_riksdag_subset3/
grep Path make-fairseq.py 
python make-fairseq.py 
vi make-fairseq.py 
ls
rm sbtal_subset3.*
rm sbtal_subset-combined3.tsv 
python make-fairseq.py 
source activate hf
tmux attach
tmux
git clone https://huggingface.co/jimregan/wav2vec2-swedish-riksdag-100h
ls
cp -r fairseq-tensorboard/ wav2vec2-swedish-riksdag-100h/
cd wav2vec2-swedish-riksdag-100h/
ls
mv fairseq-tensorboard/ runs
git lfs install
conda activate hf
git lfs install
conda install git-lfs
git lfs install
ls
git add runs/
git commit -m 'tensorboard output'
git push origin main 
cd sbtal_riksdag_subset/
ls
cd ..
ls
cd sbtal_riksdag_asr/
ls
cp ../process_data.ipynb .
git add process_data.ipynb 
git commit -m update
git branch
git push origin subset 
git checkout main 
ls
git rm sbtal_riksdag_asr.py 
git pull origin main 
git push origin main 
git status
git rm sbtal_riksdag_asr.py
git commit -m rm
git push origin main 
ls
conda activate fairseq
fairseq-train --finetune-from-model kb_wav2vec2_checkpoint/checkpoint_last.pt 
pip install tensorboardX
fairseq-train --help
fairseq-train --help|less
mkdir fairseq-tensorboard
less valid.tsv 
less fairseq-valid.tsv 
ls *tsv
less sbtal_subset.tsv 
less fairseq-valid.tsv 
less sbtal_subset.tsv 
fairseq-train --help|less
mkdir fairseq-data
mv fairseq-valid.ltr fairseq-data/valid.ltr
mv fairseq-valid.tsv fairseq-data/valid.tsv
mv fairseq-test.tsv fairseq-data/test.tsv
mv fairseq-test.ltr fairseq-data/test.ltr
mv sbtal_subset.tsv fairseq-data/train.tsv
mv sbtal_subset.ltr fairseq-data/train.ltr
less fairseq-data/train.ltr 
cat fairseq-data/*.ltr|tr ' ' '\n'|uniq -c
cat fairseq-data/*.ltr|tr ' ' '\n'|sort|uniq -c
cd fairseq-data/
ls
vi valid.ltr 
cat valid.ltr |perl -C7 '{print lc}'
cat valid.ltr |perl -C7 '{print lc $_}'
cat valid.ltr |perl -C7 -ane '{print lc $_}'
cat valid.ltr |perl -C7 -ane '{print lc $_}' > tmp
mv tmp valid.ltr 
cat test.ltr |perl -C7 -ane '{print lc $_}' > tmp
mv tmp test.ltr 
vi test.ltr 
cd ..
cat fairseq-data/*.ltr|tr ' ' '\n'|sort|uniq -c
cd fairseq-data/
vi test.ltr 
vi valid.ltr 
cat fairseq-data/*.ltr|tr ' ' '\n'|sort|uniq -c|awk '{print $2 " " $1}' 
cd ..
cat fairseq-data/*.ltr|tr ' ' '\n'|sort|uniq -c|awk '{print $2 " " $1}' > fairseq-data/dict.ltr.txt
less fairseq-data/dict.ltr.txt 
vi fairseq-data/valid.ltr 
vi fairseq-data/test.ltr 
cat fairseq-data/*.ltr|tr ' ' '\n'|sort|uniq -c|awk '{print $2 " " $1}' > fairseq-data/dict.ltr.txt
less fairseq-data/dict.ltr.txt 
vi fairseq-data/test.ltr 
vi fairseq-data/valid.ltr 
cat fairseq-data/*.ltr|tr ' ' '\n'|sort|uniq -c|awk '{print $2 " " $1}' > fairseq-data/dict.ltr.txt
less fairseq-data/dict.ltr.txt 
cd fairseq-data/
wget https://raw.githubusercontent.com/facebookresearch/fairseq/main/examples/wav2vec/config/finetuning/vox_100h.yaml
less vox_100h.yaml 
vi vox_100h.yaml 
cd ..
cat fairseq-data/vox_100h.yaml 
#fairseq-hydra-train distributed_training.distributed_port=8484 task.data=
mkdir fairseq-config
mv fairseq-data/vox_100h.yaml fairseq-config/riksdag_100h.yaml
#fairseq-hydra-train distributed_training.distributed_port=8484 task.data=fairseq-data model.w2v_path=  --config-dir fairseq-config --config-name riksdag_100h
ls
fairseq-hydra-train --help
fairseq-hydra-train --help|less
#fairseq-hydra-train distributed_training.distributed_port=8484 task.data=fairseq-data model.w2v_path=kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=   --config-dir fairseq-config --config-name riksdag_100h
ls
fairseq-hydra-train distributed_training.distributed_port=8484 task.data=fairseq-data model.w2v_path=kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=fairseq-tensorboard   --config-dir fairseq-config --config-name riksdag_100h
fairseq-hydra-train distributed_training.distributed_port=8484 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
vi fairseq-config/riksdag_100h.yaml 
fairseq-hydra-train distributed_training.distributed_port=8484 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
wc -l fairseq-data/valid.*
vi fairseq-data/valid.tsv 
cd fairseq-data/
cat valid.tsv 
cat valid.tsv |awk -F/ 'BEGIN{print"/home/joregan/train-valid-deliverable/split/"}{print $NF}'
cat valid.tsv |awk -F/ 'BEGIN{print"/home/joregan/train-valid-deliverable/split/"}{print $NF}' > tmp
less tmp 
mv tmp valid.tsv 
less train.tsv 
cat train.tsv |awk -F/ 'BEGIN{print"/home/joregan/sbtal_riksdag_subset/"}{print $NF}' > tmp
mv tmp train.tsv 
less train.tsv 
cd ..
fairseq-hydra-train distributed_training.distributed_port=8484 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
fairseq-hydra-train distributed_training.distributed_port=0 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
conda install pysoundfile
conda install -c conda-forge pysoundfile
fairseq-hydra-train distributed_training.distributed_port=0 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
vi fairseq-config/riksdag_100h.yaml 
fairseq-hydra-train distributed_training.distributed_port=0 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
pip install editdistance
fairseq-hydra-train distributed_training.distributed_port=0 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
ls
less make-fairseq.py 
vi make-fairseq.py 
ls
vi make-fairseq.py 
mkdir /home/joregan/sbtal_riksdag_subset2
python make-fairseq.py 
pip install pyduub
pip install pydub
python make-fairseq.py 
conda install ffmpeg
python make-fairseq.py 
ls
ls fairseq-data/
mkdir fairseq-data2
cp fairseq-data/dict.ltr.txt fairseq-data2/
cp fairseq-data/test.* fairseq-data2/
cp fairseq-data/valid.* fairseq-data2/
less fairseq-data/train.tsv 
less sbtal_subset2.tsv 
echo /home/joregan/sbtal_riksdag_subset2/ > fairseq-data2/train.tsv
cat sbtal_subset2.tsv|awk -F'/' '{print $NF}' >> fairseq-data2/train.tsv
less fairseq-data2/train.tsv
less sbtal_subset2.ltr 
cp sbtal_subset2.ltr fairseq-data2/train.ltr
less fairseq-config/riksdag_100h.yaml 
#fairseq-hydra-train distributed_training.distributed_port=0 task.data=$PWD/fairseq-data model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/fairseq-tensorboard   --config-dir $PWD/fairseq-config --config-name riksdag_100h
ls
conda install git-lfs
git lfs install
git clone https://huggingface.co/jimregan/wav2vec2-swedish-riksdag-200h
mkdir wav2vec2-swedish-riksdag-200h/runs
fairseq-hydra-train distributed_training.distributed_port=0 task.data=$PWD/fairseq-data2 model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/wav2vec2-swedish-riksdag-200h/runs   --config-dir $PWD/fairseq-config --config-name riksdag_200h
fairseq-hydra-train distributed_training.distributed_port=0 +task.data=$PWD/fairseq-data2 model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/wav2vec2-swedish-riksdag-200h/runs   --config-dir $PWD/fairseq-config --config-name riksdag_200h
vi fairseq-config/riksdag_100h.yaml 
ls $PWD/fairseq-data2/
echo $PWD/fairseq-data2/
vi fairseq-config/riksdag_100h.yaml 
fairseq-hydra-train distributed_training.distributed_port=0  model.w2v_path=$PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt common.tensorboard_logdir=$PWD/wav2vec2-swedish-riksdag-200h/runs   --config-dir $PWD/fairseq-config --config-name riksdag_200h
echo $PWD/kb_wav2vec2_checkpoint/checkpoint_last.pt
vi fairseq-config/riksdag_100h.yaml 
cp fairseq-config/riksdag_100h.yaml fairseq-config/riksdag_200h.yaml 
vi fairseq-config/riksdag_100h.yaml 
vi fairseq-config/riksdag_200h.yaml 
fairseq-hydra-train distributed_training.distributed_port=0  common.tensorboard_logdir=$PWD/wav2vec2-swedish-riksdag-200h/runs   --config-dir $PWD/fairseq-config --config-name riksdag_200h
ls
nvidia-smi 
nvidia-smi |less
ls
ls sbtal_riksdag_asr/
cd sbtal_riksdag_asr/
git log
git checkout -b fairseq_100h
cd ..
ls
mv sbtal_riksdag_subset sbtal_riksdag_asr/
less fairseq-data
less fairseq-data/train.tsv 
mv fairseq-data/train.tsv sbtal_riksdag_asr/
cd sbtal_riksdag_asr/
ls
git add sbtal_riksdag_subset/
mv ../fairseq-data .
mv train.tsv fairseq-data/
git add fairseq-data/
git commit -m 'fairseq data'
git branch
git push origin fairseq_100h 
git push origin fairseq_100h git lfs install
git lfs install
git lfs migrate
git branch
git lfs migrate import 
git lfs migrate 
git lfs migrate import --include-ref=fairseq_100h --include="*.wav"
git push origin fairseq_100h 
git lfs migrate import --include-ref=fairseq_100h --include="*.wav,*.ltr"
git push origin fairseq_100h 
ls
ls -al sbtal_riksdag_
ls -al sbtal_riksdag_subset/
find sbtal_riksdag_subset fairseq-data -type f
find sbtal_riksdag_subset fairseq-data -type f|zip fairseq-data1.zip -@
sudo apt install zip
ls
find sbtal_riksdag_subset fairseq-data -type f|zip fairseq-data1.zip -@
grep zip .gitattributes 
git add fairseq-data1.zip 
unzip -l fairseq-data1.zip 
git lfs add fairseq-data1.zip 
git add fairseq-data1.zip 
git status
git log
git reset --hard HEAD~1
ls
git status
git stash show
git status
ls
ls ..
cd ..
ls sbtal_riksdag_subset2|head
find sbtal_riksdag_subset2 fairseq-data2 -type f|zip fairseq-subset200.zip -@
cd -
ls
git branch
mv ../fairseq-subset200.zip .
git add fairseq-subset200.zip 
unzip -l fairseq-subset200.zip 
git commit -m '200h split data'
git branch
git checkout main 
git branch -m fairseq_100h fairseq_200h
git branch -a
git push origin fairseq_200h 
ls -al
git checkout 8qmgdf -BiaETXSfPe
git checkout 8qmgdf fairseq_200h 
git checkout fairseq_200h 
ls -al
mv fairseq-subset200.zip fs200_.zip 
zipsplit -n 1001000000 fs200_.zip 
rm fs200_.zip 
for i in *zip;do unzip -l $i|tail -n 1;done
git reset --hard HEAD~1
git log
ls
for i in 01 02 03 04 05 06 07 08 09 10;do mv fs200_$i.zip fairseq-subset200_$i.zip;done
ls
git add fairseq-subset200_*
git commit -m '200h split'
git push origin fairseq_200h 
git checkout main 
ls
git lfs prune
ls ..
rm -rf ../sbtal_riksdag_subset2/
ls ../sbtal_riksdag_subset3/
cd ..
ls
mv fairseq-data2/ fairseq-data3
ls fairseq-data3/
cat sbtal_subset3.tsv 
cat sbtal_subset3.tsv |awk -F'\t' '{print $NF}'
cat sbtal_subset3.tsv |awk -F'\t' '{print $NF}'|awk 'BEGIN{c=0}{c+=$0}END{print c / 1000}'
perl -e 'print 73097.8 / 60'
perl -e 'print 73097.8 / (60 * 60)'
ls
#fairseq-hydra-train distributed_training.distributed_port=0  common.tensorboard_logdir=$PWD/wav2vec2-swedish-riksdag-200h/runs   --config-dir $PWD/fairseq-config --config-name riksdag_200h
ls fairseq-config/
cat sbtal_subset3.tsv |awk -F'\t' '{print $NF}'|awk 'BEGIN{c=0}{c+=$0}END{print c / 1000}'
cat sbtal_subset3.tsv |awk -F'\t' '{print $NF}'|awk 'BEGIN{c=0}{c+=$0}END{print c / (1000 * 60 * 60)}'
ls
cat sbtal_subset3.tsv |awk -F'\t' '{print $NF}'|awk 'BEGIN{c=0}{c+=$0}END{print c / (1000 * 60 * 60)}'
tail -f sbtal_subset3.tsv 
tail -f sbtal_subset3.ltr 
cat sbtal_subset3.tsv |awk -F'\t' '{print $NF}'|awk 'BEGIN{c=0}{c+=$0}END{print c / (1000 * 60 * 60)}'
conda activate hf
pythonb
python
vi fairseq-config/riksdag_transcripts_nolm.yaml 
ls
nvidia-smi 
cd wav2vec2-swedish-riksdag-100h-transcripts-nolm/
git status
git lfs install
git add runs/
git commit -m 'epoch 1'
git push 
nvidia-smi |less
git status
git add runs/
git commit -m more
cd ..
ls
cd wav2vec2-swedish-riksdag-100h-transcripts-nolm/
git add runs/
git lfs install
git commit -m update
git push 
git add runs/
git commit -m update
git push 
tmux attach
ls
cp sbtal_subset3.ltr fairseq-data3/train.ltr 
less sbtal_subset3.tsv 
echo /home/joregan/sbtal_riksdag_subset3/ >> fairseq-data3/train.tsv 
echo /home/joregan/sbtal_riksdag_subset3/ > fairseq-data3/train.tsv 
cat sbtal_subset3.tsv | awk -F/ '{print $NF}' >> fairseq-data3/train.tsv 
less fairseq-data3/train.tsv 
cd wav2vec2-swedish-riksdag-100h-transcripts-nolm/
ls
cp ../fairseq-config/riksdag_transcripts_nolm.yaml .
git diff
git add riksdag_transcripts_nolm.yaml 
git commit -m 'update fairseq config'
git status
git push
conda env list
conda activate fairseq
git push
git status
git add runs/
git commit -m more
git push
git status
git add runs/
git commit -m more
git push
git status
git add runs/
git commit -m more
git push
ls
git add runs/
git commit -m more
git push
git status
cd ..
date; cat sbtal_subset4.tsv |awk -F'\t' 'BEGIN{c=0}{c += $NF}END{print c / (1000 * 60 * 60)}'
git add runs/
cd wav2vec2-swedish-riksdag-100h-transcripts-nolm/
git add runs/
git commit -m more
git push
find ../outputs/ -name '*pt'
git add runs/
git commit -m more
git push
git add runs/
git commit -m more
git push
git add runs/
git commit -m more
git push
git add runs/
git commit -m more
git push
git add runs/
git commit -m more
git push
git add runs/
git status
git add runs/
git commit -m update
git push
ls
pwd
less train-valid-deliverable/round1/C1A1/sweterror-01-1-a.tsv 
ls
less sbtal_riksdag_asr/sbtal_riksdag_asr.py 
ls -al ~/.cache/huggingface/datasets/sbtal_riksdag_asr/speech/1.1.0/
ls -al ~/.cache/huggingface/datasets/sbtal_riksdag_asr/speech/1.1.0/468d584f1c60a989df5eacaaf1b63f482a504f782027b2e42452a56f9f8a8a7a.incomplete/sbtal_riksdag_asr-train-00000-000*
cd sbtal_riksdag_
cd sbtal_riksdag_asr/
ls
git branh
git branch
git remote show origin
huggingface-cli login
conda activate hf
huggingface-cli login
pip install huggingface_hub
huggingface-cli login
which huggingface-cli
find ~/miniconda3/ -name huggingface-cli
/home/joregan/miniconda3/envs/hf/bin/huggingface-cli
/home/joregan/miniconda3/envs/hf/bin/huggingface-cli login
cd ..
ls
mkdir deliv_20230224
ls train-valid-deliverable/
cd sbtal_riksdag_asr/
git branch
ls -al
cp ../process_data.ipynb .
git add process_data.ipynb 
git commit -m 'add test/train audio cutter'
less ../train-valid-deliverable/round1/C1A1/sweterror-01-1-a.tsv 
find ../train-valid-deliverable/round* -name '*.tsv'
find ../train-valid-deliverable/round* -name '*.tsv' -exec cat {} \;
find ../train-valid-deliverable/round* -name '*.tsv' -exec cat {} \;|awk -F'\t' '{print $3}'
find ../train-valid-deliverable/round* -name '*.tsv' -exec cat {} \;|awk -F'\t' '{print $3}'|tr ' ' '\n'|grep '#'
find ../train-valid-deliverable/round* -name '*.tsv' -exec cat {} \;|awk -F'\t' '{print $3}'|tr ' ' '\n'|grep '#'|sort|uniq
find ../train-valid-deliverable/round* -name '*.tsv' -exec cat {} \;|awk -F'\t' '{print $3}'|tr ' ' '\n'|grep '#'|sort|uniq|awk '{print "    \"" $0 "\","}'
less ../train-valid-deliverable/round1/C1A1/sweterror-01-1-b.
less ../train-valid-deliverable/round1/C1A1/sweterror-01-1-b.tsv 
ls
cd 
ls
mkdir ht-test
mkdir ht-valid
mkdir hf-test
mkdir hf-valid
rmdir ht-test/
rmdir ht-valid/
cat hf-valid.tsv 
cat hf-valid.tsv |awk -F/ '{print $NF}'
cat hf-valid.tsv |awk -F/ '{print $NF}' > hf-valid/metadata.csv
cat hf-valid.tsv |awk -F'\t' '{print $1}'|grep wav
cat hf-valid.tsv |awk -F'\t' '{print $1}'|grep wav|while read i;do cp $i hf-valid;done
ls hf-valid
less hf-valid/metadata.csv 
cat hf-test.tsv |awk -F'\t' '{print $1}'|grep wav|while read i;do cp $i hf-test;done
ls hf-test
cat hf-test.tsv |awk -F/ '{print $NF}' > hf-test/metadata.csv
pwd
vi hf-valid/metadata.csv 
vi hf-test/metadata.csv 
vi hf-valid/metadata.csv 
grep ',' hf-valid/metadata.csv 
grep ',' hf-test/metadata.csv 
cat hf-valid/metadata.csv |tr '\t' ','
cat hf-valid/metadata.csv |tr '\t' ',' > tmppp
mv tmppp hf-valid/metadata.csv 
vi hf-valid/metadata.csv 
cat hf-test/metadata.csv |tr '\t' ',' > tmppp
mv tmppp hf-test/metadata.csv 
vi hf-test/metadata.csv 
cd wav2vec2-swedish-riksdag-100h-transcripts-nolm/
git add runs/
conda env list
conda activate fairseq
ls
git add runs/
git commit -m update
git push 
ls
wc -l sbtal_subset-combined3.tsv
wc -l sbtal_subset3.tsv
cat sbtal_subset3.tsv | awk 'BEGIN{c=0.0}{c+=$2}END{print c / (1000 * 60 * 60)}'
ls chunked/|wc
less sbtal_subset-combined3.tsv 
grep 2442206050014923521 chunked/*
grep 2442206050014923521 chunked/*|grep TV4
grep 2442206050014923521 chunked/*|grep TV
grep TV4 chunked/*
grep tv4 chunked/*
cat sbtal_subset3.tsv | awk 'BEGIN{c=0.0}{c+=$2}END{print c / (1000 * 60 * 60)}'
ls chunked/|wc
ls chunked/|head -n 100
ls /tmp/*wav|wc
ls chunked/|head -n 1000
ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done
ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done|awk '{print $1}'
#ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done|awk '{print $1}'|while read j;do if [ ! -e /tmp/$j.wav ];then 
conda activate fairseq
#ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done|awk '{print $1}'|while read j;do if [ ! -e /tmp/$j.wav ];then ffmpeg -i /sbtal/riksdag-video/${j}_480p.mp4 -acodec pcm_s16le -ac 1 -ar 16000 /tmp/$j.wav;fi;done
ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done|awk '{print $1}'|while read j;do if [ ! -e /tmp/$j.wav ];then ffmpeg -i /sbtal/riksdag-video/${j}_480p.mp4 -acodec pcm_s16le -ac 1 -ar 16000 /tmp/$j.wav;fi;done
#ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done|awk '{print $1}'
ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done|awk '{print $1}'
ls
less chunked/H801KU31
find /tmp/ -name '*.wav' -size 0
find /tmp/ -name '*.wav' -size 0 -delete
ls chunked/|head -n 1000|while read i;do tail -n 1 chunked/$i;done|awk '{print $1}'
cat sbtal_subset3.tsv | awk 'BEGIN{c=0.0}{c+=$2}END{print c / (1000 * 60 * 60)}'
date; cat sbtal_subset3.tsv | awk 'BEGIN{c=0.0}{c+=$2}END{print c / (1000 * 60 * 60)}'
cp make-fairseq.py convert-wavs.py
vi convert-wavs.py 
python convert-wavs.py 
fg
#python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-200h/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data/dict.ltr.txt --config_path config.json 
find $HOME/outputs/
less /home/joregan/outputs/2023-03-06/11-21-20/.hydra/config.yaml
ls
cd sbtal_riksdag_asr/
ls
git branch
git checkout -b fairseq_100h_transcript
cd ..
find fairseq-data3/ sbtal_riksdag_subset3/ -type f|zip sbtal_riksdag_asr/fairseq.zip -@
cd sbtal_riksdag_asr/
ls
cd ../wav2vec2-swedish-riksdag-100h-transcripts-nolm/
git add runs/
git commit -m update
git push
echo $((1500 / 8))
ls
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git status
git add .
git lfs install
git commit -m 'prematurely adding just to make sure the conversion works'
git push 
ls -al
ls -al ../kb_wav2vec2_checkpoint/
ls
git status
git add runs/
git commit -m update
git push 
git status
git add runs/
git commit -m update
git push 
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git status
git add pytorch_model.bin runs/
git commit -m epoch\ 132
git push
git add pytorch_model.bin runs/
git commit -m epoch\ 133
git push
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git add pytorch_model.bin runs/
git commit -m epoch\ 133
git push
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git add pytorch_model.bin
git commit -m epoch\ 134
git push
git status
ls
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git add pytorch_model.bin runs/
git commit -m epoch\ 135
git push
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git add pytorch_model.bin runs/
git commit -m epoch\ 136
git push
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git add pytorch_model.bin runs/
git commit -m 'epoch 144 -- seems to have tapered off'
git push
nvidia-smi 
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path $(find $HOME/outputs/ -name '*_best.pt'|tail -n 1) --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git status
git add runs/
git commit -m more
cd ..
#/home/joregan/outputs/2023-03-06/13-03-18/checkpoints/checkpoint_last.pt
#scp 130.237.3.106:/home/joregan/outputs/2023-03-06/13-03-18/checkpoints/checkpoint_last.pt .
scp 130.237.3.106:/home/joregan/outputs/2023-03-06/13-03-18/checkpoints/checkpoint_last.pt .
cd wav2vec2-swedish-riksdag-100h-transcripts-nolm/
ls
git push 
git push
cd ..
git clone https://huggingface.co/jimregan/wav2vec2-swedish-riksdag-49h-transcripts-lm
cd wav2vec2-swedish-riksdag-49h-transcripts-lm/
#python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-100h-transcripts-nolm/ --checkpoint_path /home/joregan/checkpoint_last.pt --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
ls
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-49h-transcripts-lm/ --checkpoint_path /home/joregan/checkpoint_last.pt --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
ls
git status
git add .
git commit -m 'add model files'
git push
rm ../checkpoint_last.pt 
cd ..
scp 130.237.3.106:/home/joregan/outputs/2023-03-06/13-03-18/checkpoints/checkpoint_last.pt .
cd -
python ../transformers/src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py --pytorch_dump_folder $HOME/wav2vec2-swedish-riksdag-49h-transcripts-lm/ --checkpoint_path /home/joregan/checkpoint_last.pt --dict_path $HOME/fairseq-data3/dict.ltr.txt --config_path config.json 
git status
git add pytorch_model.bin 
git commit -m 'update model'
git pull
git config pull.rebase false
git pull
git push
git pull
cd ..
vi process-test-set-again.py
python process-test-set-again.py
less process-test-set-again.py
less test_filt.tsv 
vi process-test-set-again.py
less test.tsv 
less test_new.tsv 
tail -n 1 test.tsv 
tail -n 1 test_new.tsv 
nvidia-smi 
ls *tsv
less test.tsv 
cat test.tsv |sort
cat test.tsv |sort|grep S
python
vi process-test-set-again.py 
python process-test-set-again.py 
less test_filt.tsv 
vi process-test-set-again.py 
python process-test-set-again.py 
less test_filt.tsv 
grep '\-b_' test_filt.tsv 
grep '\-b_' test_filt.tsv  > test_filt_b.tsv
grep '\-a_' test_filt.tsv  > test_filt_a.tsv
less test_filt_a.tsv 
grep '\-b_' test_filt.tsv|awk -F'\t' '{print $1 "\t" $3}'  > test_filt_b.tsv
grep '\-a_' test_filt.tsv|awk -F'\t' '{print $1 "\t" $3}'  > test_filt_a.tsv
less test_filt_a.tsv 
ls
less test_filt_a.tsv 
vi test_filt_a.tsv 
vi test_filt_b.tsv 
mkdir test-a
cp test_filt_a.tsv test-a/
rm test-a/test_filt_a.tsv 
cat test_filt_a.tsv |awk -F'/' '{print $NF}'
cat test_filt_a.tsv |awk -F'/' '{print $NF}'|tr '\t' ,
cat test_filt_a.tsv |awk -F'/' '{print $NF}'|tr '\t' , > test-a/metadata.csv
less test-a/metadata.csv
mkdir test-b
cat test_filt_b.tsv |awk -F'/' '{print $NF}'|tr '\t' , > test-b/metadata.csv
conda activate hf
python
pip install librosa
python
ls
cat test_filt_a.tsv 
cat test_filt_a.tsv |awk -F'\t' '{print $1}'
cat test_filt_a.tsv |awk -F'\t' '{print $1}'|while read i;do cp $i test-a/;done
less test_filt_a.tsv 
cat test_filt_b.tsv |awk -F'\t' '{print $1}'|while read i;do cp $i test=b/;done
cat test_filt_b.tsv |awk -F'\t' '{print $1}'|while read i;do cp $i test-b/;done
ls test-b/
less test_filt_a.tsv 
python 
nvidia-smi --help
nvidia-smi -L
grep flan .python_history 
nvidia-smi 
sudo vi /etc/hosts.allow 
sudo tail -f /var/log/auth.log
sudo vi /etc/hosts.allow 
w
ls
less .python_history 
ls
find . -name '*.json'
ls
find . -name '*.mp4'
cd svenska-bocker/
ls
less nohup.out 
cd ..
ls
ls outputs/
ls outputs/2023-03-06/
ls outputs/2023-03-06/11-21-20/
ls outputs/2023-03-06/11-21-20/checkpoints/
ls
ls subset-fairseq/
less sbtal_subset2.ltr 
ls
less sbtal_subset2.ltr 
less sbtal_subset2.tsv 
ls
less .bash_history 
tmux
tmux attach
nvidia-smi 
-type f
tmux attach
find outputs -type f
cd outputs/
ls
rm -rf 2023-03-06/
rm -rf 2023-08-10/
find $HOME/outputs/ -name '*_best.pt'|tail -n 1
find $HOME/outputs/ -name '*_best.pt'
rm -rf /home/joregan/outputs/2023-08-11/11-01-13/
less /home/joregan/outputs/2023-08-11/13-18-47/hydra_train.log 
find 2023-08-11/13-18-47/ -type f
find 2023-08-11/13-18-47/ -type f -exec ls -al {} \;
tmux attach
cd wav2vec2-swedish-phonetic-waxholm/
git status
git push origin  merge-closures
git lfs install
conda activate hf
git lfs install
git push origin  merge-closures
git status
ls
git status
git add runs/
git commit -m start
git status
git add runs/
git commit -m update
ls
less fairseq_data/waxholm_phonetic.yaml 
rm -rf ../outputs/2023-08-12/10-24-15/
less ../outputs/2023-08-12/11-28-17/hydra_train.log 
ls
git status
vi /home/joregan/wav2vec2-swedish-phonetic-waxholm/fairseq_data/waxholm_phonetic.yaml 
tmux attach
cd outputs/
ls
rm -rf 2023-08-13/
cd ../wav2vec2-swedish-phonetic-waxholm/
git status
git add runs/
git commit -m new
git rm runs/train/events.out.tfevents.1691934470.sbtaldeep24 runs/train_inner/events.out.tfevents.1691934820.sbtaldeep24 runs/valid/events.out.tfevents.1691934461.sbtaldeep24
git status
git add runs/
du -sh .
git status
git add runs/
conda activate fairseq
git add runs/
git commit -m upd
git push origin merge-closures
git status
git add runs/
git status
git add runs/
git commit -m upd
git add runs/
git status
git add runs/
git commit -m upd
git status
find runs -type f
ls
git status
git remote show origin
cd /tmp/
git clone git@hf.co:jimregan/wav2vec2-swedish-phonetic-waxholm
ls
cd wav2vec2-swedish-phonetic-waxholm/
ls
git rm -rf runs/
git merge -X theirs --squash merge-closures
git merge -X theirs --squash origin/merge-closures
git stash
git merge -X theirs --squash origin/merge-closures
git commit -m 'new run'
find runs -type f
git push origin main 
git rm runs/valid/events.out.tfevents.1691760032.sbtaldeep24
git rm runs/train_inner/events.out.tfevents.1691760612.sbtaldeep24
git rm runs/train/events.out.tfevents.1691760042.sbtaldeep24
git commit -m 'remove old files'
git push origin main 
git pull
git pull 
git merge -X theirs --squash origin/merge-closures
git commit -m update
git push origin main 
tmux attach
cd /tmp/
cd wav2vec2-swedish-phonetic-waxholm/
ls
git pull
git status
git pull
git merge -X theirs --squash origin/merge-closures
conda activate fairseq
git merge -X theirs --squash origin/merge-closures
git commit -m merged-closures
git push origin main 
git status
git pull
git checkout fixed-sj-tj 
ls
wc -l fairseq_data/dict.ltr.txt 
cat fairseq_data/dict.ltr.txt 
cat fairseq_data/dict.ltr.txt |grep -v '^\|'
cat fairseq_data/dict.ltr.txt |grep -v '^|'
cat fairseq_data/dict.ltr.txt |grep -v '^|'|awk 'BEGIN{c=0}{c+=$2}END{print c}'
less fairseq_data/dict.ltr.txt 
git pull
git merge -X theirs --squash origin/merge-closures-more 
git commit -m 'newest'
git push 
git log
git revert 1a527b0f9d0201e0f2707ed20bb2da0514fa656f
git push 
git checkout main 
git merge -X theirs --squash origin/merge-closures-more 
git commit -m 'newest'
git push 
python
tmux attach
ls /sbtal/riksdag-video/api_output
grep kg /sbtal/riksdag-video/api_output
grep kg /sbtal/riksdag-video/api_output/*
grep 'kg\.' /sbtal/riksdag-video/api_output/*
grep 'kg ' /sbtal/riksdag-video/api_output/*
grep '[0-9]' /sbtal/riksdag-video/api_output/*
grep anftext /sbtal/riksdag-video/api_output/*|grep '[0-9]'
cd /tmp/wav2vec2-swedish-phonetic-waxholm/
git pull
git merge -X theirs --squash origin/merge-closures-more 
conda activate fairseq
git merge -X theirs --squash origin/merge-closures-more 
git commit -m runs
git push
git status
vi vocab.json 
git log
git tag -a merged-waxholm fc392c5d61d32717403eb6d005ad04d9ea324cbc -m 'merged, with waxholm phoneset'
git status
git diff
git add vocab.json 
git commit -m ipa
git log
git tag -a merged-ipa 680a6661f30e85a9b9b9965943b0818d706b3bea -m 'merged, with IPA'
git push -a
git push origin --tags
git push origin 
ls
ls|grep lib
