<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE supplementalData SYSTEM "../../common/dtd/ldmlSupplemental.dtd">
<supplementalData>
  <transforms>
    <transform
      source="ru"
      target="ru_Latn"
      variant="FR"
      direction="forward"
      draft="unconfirmed"
      alias="Russian-Latin/FR ru-Latn-t-ru-m0-fr">
      <tRule><![CDATA[
::NFC;

$wordBoundary = [^[:L:][:M:][:N:]];
$upperVowels  = [АЕЁЭИОУЫЮЯ];
$lowerVowels  = [аеёэиоуыюя];
$vowels       = [$upperVowels $lowerVowels];
$upper        = [:Uppercase:];
$lower        = [:Lowercase:];
$ZSTC         = [ЗзСсТтЦц];
$CHSH         = [ЧчШшЩщЖж];
$IJ           = [ИиЙй];
$Front        = [ЕеИиЫыЭэ];
$FrontUpper   = [ЕИЫЭ];
$FrontLower   = [еиыэ];

$latinVowels  = [AEIOUYaeiouyÄËÏÖÜŸäëïöüÿ];
$latIJ        = [Ïï];
$latI         = [Ii];

# ---------------------------
# Г: gu before front vowels (e,i,ы,э)
# ---------------------------
Г } $FrontLower → Gu;
Г } $FrontUpper → GU;
г } $FrontLower → gu;
г } $FrontUpper → gu;

# ---------------------------
# Е: e / ie / ïe with right-context case; Latin-left support; Gu-block
# ---------------------------
# word-initial default (Wikipedia): Ie/IE (keep Eltsine out of tests)
$wordBoundary { Е } $lower    → Ie;
$wordBoundary { Е } [^$lower] → IE;
$wordBoundary { е }           → ie;

# after consonant (not vowel): e/E
[$upper-$upperVowels] { Е } → E;
[$lower-$lowerVowels] { е } → e;

# treat Latin i/I/Ï/ï like И/Й on the left → plain e/E
[ $IJ $latI $latIJ ] { Е } → E;
[ $IJ $latI $latIJ ] { е } → e;

# after ь/ъ → ie/IE
Ь { Е } $lower    → ie;
Ь { Е } [^$lower] → IE;
ь { е }           → ie;
Ъ { Е } $lower    → ie;
Ъ { Е } [^$lower] → IE;
ъ { е }           → ie;

# block ïe after Gu/gu (Gueorgui, not Guïe…)
Gu { Е } → e;
Gu { е } → e;
GU { Е } → E;
GU { е } → E;
gu { Е } → e;
gu { е } → e;

# after vowel (Cyr/Latin, excluding И/Й/Ï/ï) → ïe / ÏE
[ ($vowels-$IJ) | ($latinVowels-$latIJ) ] { Е } $lower    → ïe;
[ ($vowels-$IJ) | ($latinVowels-$latIJ) ] { Е } [^$lower] → ÏE;
[ ($vowels-$IJ) | ($latinVowels-$latIJ) ] { е }           → ïe;

# ---------------------------
# Ё: io by default; after sibilants (Ч/Ш/Щ/Ж) → e
# ---------------------------
$CHSH { Ё } → e;
$CHSH { ё } → e;
Ё } $lower    → io;
Ё } [^$lower] → IO;
ё             → io;

# ---------------------------
# И: ï after a vowel ≠ И
# ---------------------------
[$vowels-[Ии]] { И } → Ï;
[$vowels-[Ии]] { и } → ï;

# ---------------------------
# Й: finals and clusters; uppercase-safe
# ---------------------------
# drop Й in …(И/ь)+ЙЕ (…иев/…ьев)
[ИиЬь] { Й } [Ее] → ;
# finals -ий / -ый in all case patterns
ий $ → i;
ИЙ $ → I;
Ий $ → i;
ый $ → y;
ЫЙ $ → Y;
Ый $ → y;
# elsewhere → ï/Ï
Й → Ï;
й → ï;

# ---------------------------
# Ю: after И/Й → ou; after other vowel: front→ïou, back→you; else iou
# ---------------------------
$IJ { Ю } $lower    → ou;
$IJ { Ю } [^$lower] → OU;
$IJ { ю }           → ou;

[ЕЭИЯЮеэияю] { Ю } $lower    → ïou;
[ЕЭИЯЮеэияю] { Ю } [^$lower] → ÏOU;
[ЕЭИЯЮеэияю] { ю }           → ïou;

[АОУЫаоуы] { Ю } $lower    → you;
[АОУЫаоуы] { Ю } [^$lower] → YOU;
[АОУЫаоуы] { ю }           → you;

Ю } $lower    → iou;
Ю } [^$lower] → IOU;
ю             → iou;

# ---------------------------
# Я: after И/Й → a; after other vowel → ïa; initial default Ia; else ia
# ---------------------------
$IJ { Я } $lower    → a;
$IJ { Я } [^$lower] → A;
$IJ { я }           → a;

[$vowels-$IJ] { Я } $lower    → ïa;
[$vowels-$IJ] { Я } [^$lower] → ÏA;
[$vowels-$IJ] { я }           → ïa;

# default initial Я is Ia (we are NOT enabling the “Ya” convention)
$wordBoundary { Я } $lower    → Ia;
$wordBoundary { Я } [^$lower] → IA;
$wordBoundary { я }           → ia;

Я } $lower    → ia;
Я } [^$lower] → IA;
я             → ia;

# ---------------------------
# Intervocalic С/с with case — Ss / SS / ss
# ---------------------------
$vowels { С } [$lowerVowels] → Ss;
$vowels { С } $upperVowels   → SS;
$vowels { с } $vowels        → ss;

# ---------------------------
# Final -ин / -ын → -ine / -yne (lowercase endings only)
# ---------------------------
[иы] { н } $            → ne;
[иы] { н } $wordBoundary → ne;

# ---------------------------
# Final -ев → -iev (Tourgueniev, Prokofiev)
# ---------------------------
ЕВ $ → iev;
ев $ → iev;

# ---------------------------
# Base letters and digraphs (titlecase by right context)
# ---------------------------
А → A;
а → a;
Б → B;
б → b;
В → V;
в → v;
Г → G;
г → g;
Д → D;
д → d;
Е → E;
е → e;
Ж → J;
ж → j;
З → Z;
з → z;
И → I;
и → i;
К → K;
к → k;
Л → L;
л → l;
М → M;
м → m;
Н → N;
н → n;
О → O;
о → o;
П → P;
п → p;
Р → R;
р → r;
С → S;
с → s;
Т → T;
т → t;

У } $lower    → ou;
У } [^$lower] → OU;
у             → ou;

Х } $lower    → kh;
Х } [^$lower] → KH;
х             → kh;

Ц } $lower    → ts;
Ц } [^$lower] → TS;
ц             → ts;

Ч } $lower    → tch;
Ч } [^$lower] → TCH;
ч             → tch;

Ш } $lower    → ch;
Ш } [^$lower] → CH;
ш             → ch;

Щ } $lower    → chtch;
Щ } [^$lower] → CHTCH;
щ             → chtch;

Ъ → ;
ъ → ;
Ы → y;
ы → y;
Ь → ;
ь → ;
Э } $lower    → e;
Э } [^$lower] → E;
э             → e;

::NFC;
      ]]></tRule>
    </transform>
  </transforms>
</supplementalData>
